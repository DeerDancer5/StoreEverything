<!DOCTYPE html>
<html xmlns:th="https://www.thymeleaf.org" xmlns:id="http://www.w3.org/1999/xhtml">
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>User</title>
    <link rel="stylesheet" type="text/css" href="/css/style.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">
</head>
<body>

<div th:insert="~{navbar :: navbar}"></div>

<div class="container">
    <div class="col my-4" th:align="center">
        <h1 th:text="${Name}"/>
    </div>
</div>




<div class="container">

    <div class="row">
        <div class="col-md-2"><hr>
            <div th:align="left">
                <div class="row my-2">
                    Category:
                </div>
                <form th:action="@{/notes}" th:object="${noteRequest}" th:field="selectedCategory" method="post">
                <li th:each="category : ${CategoryList}">
                    <label th:for="${category}" th:text="${category.getName()}" ></label>
                    <input type="checkbox" th:field="*{selectedCategory}" th:value="${category.getName()}"/>

                </li>
                    <input type="hidden"  th:value="${pageSize}" th:name="pageSize"/>
                    <input type="hidden"  th:value="${page}" th:name="page"/>
                    <input type="hidden"  th:value="${sortBy}" th:name="sortBy"/>
                    <input type="hidden"  th:value="${sortDir}" th:name="sortDir">

                    <div class="field">
                        <button class="ui button" type="submit">Filter</button>
                    </div>
                </form>

                <hr>
            </div>
        </div>


        <div class="col-md-10"><hr>
            <div class="row">
                <td>
                    <form th:action="@{/notes/add}"  method="get">

                        <button  type="submit">
                            +Add note
                        </button>
                    </form>
                </td>
                <form th:action="@{/notes}" th:object="${noteRequest}" method="post">

                    <div class="col-md-12" th:align="left">

                        <div>Sort by:
                            <select name="sortBy">
                                <option th:each="choice : ${SortOptions}"
                                        th:value="${choice}"
                                        th:selected="(${choice.toLowerCase()} == ${sortBy})"
                                        th:text="${choice}">
                                </option>
                            </select>
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type="radio" th:checked="${sortDir.contains('asc')}" th:name="sortDir" id="option1" value="asc">
                                <label class="form-check-label" for="option1">Ascending</label>
                            </div>
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type="radio" th:name="sortDir" th:checked="${sortDir.contains('desc')}" id="option2" value="desc">
                                <label class="form-check-label" for="option2">Descending</label>
                            </div>
                            <input type="hidden"  th:value="${page}" th:name="page"/>
                            <input type="hidden"  th:value="${pageSize}" th:name="pageSize"/>
                            <input type="hidden"  th:value="${selectedCategory}" th:name="selectedCategory"/>

                            <input type="submit"  value="Sort"/>
                        </div>
                    </div>
                </form>
            <div class="col-md-5">
                    <span>
                        <div th:align="right">Page
                        <span class="Strona" th:text="${page+1}"></span>
                        of
                        <span class="Ilosc" th:text="${NumberOfPages+1}"></span>
                        </div>
                    </span>
            </div>
        </div>

            <table class="table table-striped ">
                <thead class="table-dark">
                <tr>

                    <th scope="col">Name</th>
                    <th scope="col">Category</th>
                    <th scope="col">Date</th>
                    <th scope="col"></th>


                </tr>
                </thead>
                <tbody>
                <tr th:each="note: ${NotesList}">
                    <td th:text="${note.getTitle()}"/>
                    <td th:text="${note.getCategoryName()}"/>
                    <td th:text="${note.dateToString()}"/>
                    <td>
                        <form th:action="@{|/notes/edit/${note.getId()}|}"  method="get">

                            <button  type="submit">
                                <i>Edit</i>
                            </button>
                        </form>
                    </td>
                </tr>

                </tbody>

            </table>
        <div class="row" th:align="left">
            <div class="col">
                <form th:action="@{/notes}" th:object="${noteRequest}" method="post">

                    <p>Items per page:
                        <select name="pageSize">
                            <option th:value="${NumberOfElements}" th:text="all"></option>
                            <option th:each="choice : ${SizeOptions}"
                                    th:value="${choice}"
                                    th:selected="(${choice} == ${pageSize})"
                                    th:text="${choice}"></option>

                        </select>
                        <input type="hidden"  th:value="${sortBy}" th:name="sortBy">
                        <input type="hidden"  th:value="${sortDir}" th:name="sortDir">
                        <input type="hidden"  th:value="${page}" th:name="page">

                        <input type="hidden"  th:value="${selectedCategory}" th:name="selectedCategory"/>
                        <input type="submit"  value="Change"/>
                    </p>
                </form>

            </div>
        </div>
        <div class="row">
            <div class="col" th:aligm="left">
                <a th:if="${page>0}" th:href="@{/notes(sortBy=${sortBy},pageSize=${pageSize},sortDir=${sortDir},page=${page}-1,selectedCategory=${selectedCategory})}">
                    Previous page</a>
            </div>
            <div class="col" th:align="right">
                <a th:if="${page<NumberOfPages}" th:href="@{/notes(sortBy=${sortBy},pageSize=${pageSize},sortDir=${sortDir},page=${page}+1,selectedCategory=${selectedCategory})}">
                    Next page
                </a>
            </div>

        </div>
        </div>
    </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe" crossorigin="anonymous"></script>
</body>
</html>